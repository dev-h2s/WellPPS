<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Success</title>
</head>
<body>
<h1>환영합니다! <span id="username"></span>님</h1>
<button id="go-to-my-page">마이 페이지</button>
<button id="logout">로그아웃</button>

<script>
    // URL에서 사용자 이름 추출
    const params = new URLSearchParams(window.location.search);
    const username = params.get('username');

    // 사용자 이름을 화면에 표시
    document.getElementById('username').textContent = username;

    // 마이 페이지로 이동
    document.getElementById('go-to-my-page').addEventListener('click', function() {
        window.location.href = 'my-page.html'; // 마이 페이지로 이동
    });

    // 로그아웃 처리
    document.getElementById('logout').addEventListener('click', function() {
        // 로그아웃 요청을 서버에 보내기
        fetch('/init/logout', {
            method: 'POST',
            credentials: 'include' // 현재 사용자 세션의 쿠키를 포함시키기 위해 필요합니다.
        })
            .then(response => {
                if (!response.ok) {
                    return response.text().then(text => {
                        throw new Error(text || 'Logout failed')
                    });
                }
                // 로그아웃 성공 시 쿠키 삭제
                document.cookie = 'token=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;';
                // 로그인 페이지로 리다이렉트
                window.location.href = 'login.html';
            })
            .catch(error => {
                console.error('Logout error:', error);
                alert('Logout error: ' + error.message);
            });
    });
</script>
</body>
</html>